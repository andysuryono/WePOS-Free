/**
 * Filename: purchase.validasiOrder.js
 * Generated 2019-03-07 at 01:19:26 AM
 */
Ext.define('ExtApp.modules.master_pos.model.model_masterItem',{extend:'Ext.data.Model',alias:'model_masterItem',fields:[{name:'id',type:'int'},{name:'item_code',type:'string'},{name:'item_sku',type:'string'},{name:'item_name',type:'string'},{name:'item_code_name',type:'string'},{name:'item_name_code',type:'string'},{name:'item_desc',type:'string'},{name:'item_manufacturer',type:'string'},{name:'sales_price',type:'string'},{name:'sales_price_show',type:'string'},{name:'item_price',type:'string'},{name:'item_price_show',type:'string'},{name:'item_hpp',type:'string'},{name:'item_hpp_show',type:'string'},{name:'last_in',type:'string'},{name:'last_in_show',type:'string'},{name:'total_qty_stok',type:'string'},{name:'item_type',type:'string'},{name:'item_type_name',type:'string'},{name:'item_image',type:'string'},{name:'item_image_show',type:'string'},{name:'item_image_src',type:'string'},{name:'category_id',type:'int'},{name:'item_category_name',type:'string'},{name:'item_category_code',type:'string'},{name:'subcategory_id',type:'int'},{name:'item_subcategory_name',type:'string'},{name:'item_subcategory_code',type:'string'},{name:'unit_id',type:'int'},{name:'unit_name',type:'string'},{name:'unit_code',type:'string'},{name:'supplier_id',type:'int'},{name:'supplier_name',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'use_for_sales',type:'int'},{name:'use_for_sales_text',type:'string'},{name:'id_ref_menu',type:'int'},{name:'sales_use_tax',type:'int'},{name:'sales_use_tax_text',type:'string'},{name:'sales_use_service',type:'int'},{name:'sales_use_service_text',type:'string'},{name:'is_kerjasama',type:'int'},{name:'is_kerjasama_text',type:'string'},{name:'persentase_bagi_hasil',type:'string'},{name:'total_bagi_hasil',type:'string'},{name:'total_bagi_hasil',type:'string'},{name:'total_bagi_hasil_show',type:'string'},{name:'use_stok_kode_unik',type:'int'},{name:'use_stok_kode_unik_text',type:'string'},{name:'min_stock',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterItem/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterUnit',{extend:'Ext.data.Model',alias:'model_masterUnit',fields:[{name:'id',type:'int'},{name:'unit_name',type:'string'},{name:'unit_code',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterUnit/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterDivisi',{extend:'Ext.data.Model',alias:'model_masterDivisi',fields:[{name:'id',type:'int'},{name:'divisi_name',type:'string'},{name:'divisi_desc',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterDivisi/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterSupplier',{extend:'Ext.data.Model',alias:'model_masterSupplier',fields:[{name:'id',type:'int'},{name:'supplier_code',type:'string'},{name:'supplier_name',type:'string'},{name:'supplier_contact_person',type:'string'},{name:'supplier_address',type:'string'},{name:'supplier_phone',type:'string'},{name:'supplier_fax',type:'string'},{name:'supplier_email',type:'string'},{name:'supplier_status',type:'string'},{name:'supplier_status_text',type:'string'},{name:'keterangan_blacklist',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterSupplier/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterSupplierItem',{extend:'Ext.data.Model',alias:'model_masterSupplierItem',fields:[{name:'id',type:'int'},{name:'supplier_id',type:'string'},{name:'supplier_name',type:'string'},{name:'supplier_address',type:'string'},{name:'unit_id',type:'string'},{name:'unit_name',type:'string'},{name:'supplier_item_id',type:'string'},{name:'item_id',type:'string'},{name:'item_code',type:'string'},{name:'item_code_name',type:'string'},{name:'item_name',type:'string'},{name:'item_price',type:'string'},{name:'item_price_show',type:'string'},{name:'item_hpp',type:'string'},{name:'item_hpp_show',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'from_supplier_item',type:'string'},{name:'last_in',type:'string'},{name:'last_in_show',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterSupplierItem/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.purchase.model.model_validasiOrder',{extend:'Ext.data.Model',alias:'model_validasiOrder',fields:[{name:'id',type:'int'},{name:'ro_number',type:'string'},{name:'ro_date',type:'string'},{name:'ro_memo',type:'string'},{name:'ro_from',type:'string'},{name:'ro_total_qty',type:'string'},{name:'ro_status',type:'string'},{name:'ro_status_text',type:'string'},{name:'divisi_id',type:'string'},{name:'divisi_name',type:'string'},{name:'total_request',type:'string'},{name:'total_validated',type:'string'},{name:'is_active',type:'string'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'purchase/validasiOrder/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.purchase.model.model_validasiOrderDetail',{extend:'Ext.data.Model',alias:'model_validasiOrderDetail',fields:[{name:'id',type:'int'},{name:'ro_id',type:'string'},{name:'supplier_item_id',type:'string'},{name:'item_id',type:'string'},{name:'ro_detail_qty',type:'string'},{name:'ro_detail_status',type:'string'},{name:'ro_detail_status_text',type:'string'},{name:'supplier_id',type:'string'},{name:'supplier_name',type:'string'},{name:'take_reff_id',type:'string'},{name:'take_reff_detail_id',type:'string'},{name:'item_name',type:'string'},{name:'item_price',type:'string'},{name:'item_price_show',type:'string'},{name:'item_hpp',type:'string'},{name:'item_hpp_show',type:'string'},{name:'item_image',type:'string'},{name:'unit_name',type:'string'},{name:'unit_id',type:'string'},{name:'po_number',type:'string'}],proxy:{type:'ajax',url:appUrl+'purchase/validasiOrder/gridDataDetail',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.store.store_masterItem',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterItem',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterUnit',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterUnit',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterDivisi',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterDivisi',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterSupplier',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterSupplier',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterSupplierItem',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterSupplierItem',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.purchase.store.store_validasiOrder',{extend:'Ext.data.Store',model:'ExtApp.modules.purchase.model.model_validasiOrder',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.purchase.store.store_validasiOrderDetail',{extend:'Ext.data.Store',model:'ExtApp.modules.purchase.model.model_validasiOrderDetail',autoLoad:false,remoteSort:true});Ext.define("ExtApp.modules.purchase.view.validasiOrder",{openWindow:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var store_validasiOrder_grid=theApp.getStore('store_validasiOrder_grid',false);if(store_validasiOrder_grid==false){store_validasiOrder_grid=theApp.copyStore('purchase','store_validasiOrder','store_validasiOrder_grid');}
store_validasiOrder_grid.proxy.extraParams.skip_date=0;store_validasiOrder_grid.proxy.extraParams.is_dropdown=0;store_validasiOrder_grid.proxy.extraParams.not_cancel=1;var helperGrid=theApp.getHelper('Grid');var phpJs=theApp.getHelper('phpJs');var selModel_validasiOrder=Ext.create('Ext.selection.CheckboxModel',{listeners:{}});me.pagingtb_validasiOrder=helperGrid.paging({ds:store_validasiOrder_grid,title:'Validation Order'});return desktop.createWindow({id:me.id,title:'Validation Order',width:850,height:500,iconCls:'icon-grid',animCollapse:false,constrainHeader:true,resizable:true,maximized:false,border:false,border:0,layout:{type:'border'},items:[{xtype:'form',title:'Filter',width:330,region:'west',id:'form_filter_validasiOrder',split:true,collapsible:true,splitterResize:false,collapseMode:'mini',animCollapse:true,scroll:false,bodyPadding:10,margin:'0 0 0 0',items:[{xtype:'textfield',name:'keywords',labelWidth:60,labelSeparator:'',emptyText:'Keywords: RO.NO',anchor:'100%',margin:'0 0 15 0',listeners:{specialkey:function(field,e){if(e.getKey()==e.ENTER){me.search_validasiOrder();}}}},{xtype:'panel',border:0,layout:{type:'column'},margin:'0 0 15 0',items:[{xtype:'datefield',fieldLabel:'Date From',name:'date_from',labelSeparator:'',format:'d-m-Y',altFormats:'Y-m-d|d-m-Y|dmY|Ymd',margin:'5 0 0 0',labelWidth:65,width:170,value:phpJs.date('d-m-Y'),allowBlank:false},{xtype:'datefield',fieldLabel:' To ',name:'date_till',labelSeparator:'',format:'d-m-Y',altFormats:'Y-m-d|d-m-Y|dmY|Ymd',margin:'5 0 0 10',labelWidth:20,width:125,value:phpJs.date('d-m-Y'),allowBlank:false}]},{xtype:'container',style:'text-align:right',border:0,items:[{xtype:'button',text:'Search',scale:'medium',margin:'15 0 0 0',itemId:'btnFilterSearch_validasiOrder',tooltip:'Search',iconCls:'btn-search',handler:function(){me.search_validasiOrder();}},{xtype:'button',text:'Reset',scale:'medium',margin:'15 60 0 10',itemId:'btnFilterReset_validasiOrder',tooltip:'Reset',iconCls:'btn-reset',handler:function(){var form=Ext.getCmp('form_filter_validasiOrder').getForm();form.reset();form.findField('keywords').setValue('');form.findField('date_from').setValue(phpJs.date('01-m-Y'));form.findField('date_till').setValue(phpJs.date('t-m-Y'));me.search_validasiOrder();}}]}]},{xtype:'gridpanel',margins:'0 0 0 0',region:'center',store:store_validasiOrder_grid,id:'grid_validasiOrder',scroll:true,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'ro_number',text:'RO.NO',width:100},{xtype:'datecolumn',dataIndex:'ro_date',text:'Date',width:100,format:'d-m-Y'},{xtype:'gridcolumn',dataIndex:'divisi_name',text:'Divisi',width:200},{xtype:'gridcolumn',dataIndex:'ro_from',text:'Req.From',width:170},{xtype:'gridcolumn',dataIndex:'total_request',text:'Total<br>Request',width:100},{xtype:'gridcolumn',dataIndex:'total_validated',text:'Total<br>Validated',width:100}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_validasiOrder').getSelectionModel().selected;if(getSelection.length>0){me.formType='edit';me.edit_data=rec.data;me.createWindow(me,'add_validasiOrder');}}},bbar:me.pagingtb_validasiOrder,dockedItems:[{xtype:'toolbar',dock:'top',items:[{text:'Filter',itemId:'filterButton_validasiOrder',tooltip:'Filter Validation Order',iconCls:'btn-search',listeners:{click:function(){Ext.getCmp('form_filter_validasiOrder').toggleCollapse();}}},'->',{text:'Refresh',itemId:'refreshButton_validasiOrder',tooltip:'Refresh Validation Order',iconCls:'btn-refresh',handler:function(){Ext.getCmp('grid_validasiOrder').store.load();}}]}]}],listeners:{boxready:function(){Ext.getCmp('form_filter_validasiOrder').toggleCollapse();store_validasiOrder_grid.load();},show:function(){}}});},add_validasiOrder:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Validation Order Item';var store_validasiOrderDetail=theApp.getStore('purchase.store_validasiOrderDetail',false);var store_validasiOrderDetailTemp=theApp.getStore('store_validasiOrderDetailTemp',false);if(store_validasiOrderDetailTemp==false){me.store_validasiOrderDetailTemp=theApp.copyStore('purchase','store_validasiOrderDetail','store_validasiOrderDetailTemp');}
var helperGridDetail=theApp.getHelper('Grid');var phpJs=theApp.getHelper('phpJs');var selModel_validasiOrderDetail=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_validasiOrderDetail').down('#deleteButton_validasiOrderDetail').setDisabled(selections.length==0);}}});return desktop.createWindow({id:me.id+'_add_validasiOrder',title:Titletext,width:800,height:550,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:true,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'panel',height:545,title:'',bodyPadding:5,items:[{xtype:'panel',style:'padding-bottom: 5px;',id:'validasiOrder_detailArea',title:'',border:1,items:[{xtype:'form',id:'form_validasiOrder',height:85,title:'',border:0,dockedItems:[{xtype:'panel',bodyPadding:10,width:200,title:'',dock:'left',border:false,items:[{xtype:'hidden',name:'form_type_validasiOrder',value:me.formType},{xtype:'hidden',name:'id'},{xtype:'textfield',name:'ro_number',fieldLabel:'RO.NO',labelWidth:60,readOnly:true,width:170,allowBlank:false},{xtype:'datefield',name:'ro_date',fieldLabel:'Date',labelWidth:60,width:170,format:'d-m-Y',submitFormat:'Y-m-d',readOnly:true,allowBlank:false}]},{xtype:'panel',bodyPadding:10,width:300,title:'',dock:'left',border:false,items:[{xtype:'hidden',name:'divisi_id'},{xtype:'textfield',name:'divisi_name',fieldLabel:'Divisi',readOnly:true,labelWidth:60,width:270,allowBlank:true},{xtype:'textfield',name:'ro_from',fieldLabel:'A/N',readOnly:true,labelWidth:60,width:270,allowBlank:true}]},{xtype:'panel',bodyPadding:10,width:300,title:'',dock:'left',border:false,items:[{xtype:'textarea',name:'ro_memo',fieldLabel:'Memo',labelWidth:50,rows:2,cols:25,allowBlank:true}]}]}]},{xtype:'gridpanel',height:368,store:me.store_validasiOrderDetailTemp,id:'grid_validasiOrderDetail',selModel:selModel_validasiOrderDetail,scroll:true,border:1,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'Detail ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'ro_id',text:'RO ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'ro_detail_id',text:'Detail RO ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'item_id',text:'Supply ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'supplier_item_id',text:'Supply ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'unit_id',text:'Unit ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'supplier_id',text:'Supplier ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'take_reff_id',text:'Reff ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'ro_detail_status',text:'Reff ID',hidden:true,hideable:false},{xtype:'gridcolumn',width:150,dataIndex:'item_name',text:'Items Name',sortable:false},{xtype:'gridcolumn',width:50,dataIndex:'ro_detail_qty',text:'Qty',align:'center',sortable:false},{xtype:'gridcolumn',width:100,dataIndex:'unit_name',text:'Unit',sortable:false},{xtype:'gridcolumn',width:120,dataIndex:'supplier_name',text:'Supplier',sortable:false},{xtype:'gridcolumn',width:100,dataIndex:'item_price_show',text:'Item Price',align:'right',sortable:false},{xtype:'gridcolumn',width:100,dataIndex:'item_hpp_show',text:'HPP (Average)',align:'right'},{xtype:'gridcolumn',width:100,dataIndex:'ro_detail_status_text',text:'Status',sortable:false}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){if(me.edit_data.ro_status=='take'){ExtApp.Msg.warning('Cannot Edit Item, Status RO is Purchased/Used by PO!');return true;}
var form=Ext.getCmp('form_validasiOrder').getForm();if(form.findField('form_type_validasiOrder').getValue()=='edit'){var getSelection=Ext.getCmp('grid_validasiOrderDetail').getSelectionModel().selected;if(getSelection.length>0){me.formType_Detail='edit';me.edit_data=rec.data;if(me.edit_data.ro_detail_status=='request'||me.edit_data.ro_detail_status=='validated'){me.item_idx=rec.data.item_id;me.createWindow(me,'list_supplierItem');}else{ExtApp.Msg.warning('Not Allowed to edit validated item!');return false;}}}}},dockedItems:[{xtype:'toolbar',dock:'top',items:['->',{text:'Cancel Validation',itemId:'deleteButton_validasiOrderDetail',tooltip:'Cancel Validation',iconCls:'btn-delete',disabled:true,handler:function(){if(me.edit_data.ro_status=='take'){ExtApp.Msg.warning('Cannot Cancel Item, Status RO is Purchased/Used by PO!');return true;}
var getSelection=Ext.getCmp('grid_validasiOrderDetail').getSelectionModel().selected;if(getSelection.length>0){me.delete_data=getSelection.items[0].data;if(me.delete_data.ro_detail_status!='validated'){ExtApp.Msg.info('Cancel only Validated Items');}else{me.deleteConfirm_validasiOrderDetail();}}else{ExtApp.Msg.info('Please select the data to be cancel!');}}},'-',{text:'Refresh',itemId:'refreshButton_validasiOrderDetail',tooltip:'Refresh Validation Order Detail',iconCls:'btn-refresh',handler:function(){var form=Ext.getCmp('form_validasiOrder').getForm();if(form.findField('form_type_validasiOrder').getValue()=='add'){Ext.getCmp('grid_validasiOrderDetail').store.loadData(me.storeValidasiOrderDetail_dataTemp);}else{Ext.getCmp('grid_validasiOrderDetail').store.load();}}}]}]}]}],buttons:['->',{text:'Save',formBind:true,id:'btnSave_validasiOrder',iconCls:'btn-save',handler:function(){me.save_validasiOrder();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_validasiOrder');}}],listeners:{show:function(){var form=Ext.getCmp('form_validasiOrder').getForm();var ro_id=-1;form.setValues(me.edit_data);var ro_id=me.edit_data.id;var myMask=new Ext.LoadMask(Ext.getCmp('validasiOrder_detailArea'),{msg:"Loading..."});myMask.show();me.store_validasiOrderDetailTemp.proxy.extraParams.ro_id=ro_id;me.store_validasiOrderDetailTemp.proxy.extraParams.limit=99999;me.store_validasiOrderDetailTemp.load({callback:function(){myMask.hide();}});}}});},list_supplierItem:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='List Supplier Item';var helperGrid=theApp.getHelper('Grid');var phpJs=theApp.getHelper('phpJs');me.store_supplierItemAutocomplete=theApp.getStore('store_supplierItemAutocomplete',false);if(me.store_supplierItemAutocomplete==false){me.store_supplierItemAutocomplete=theApp.copyStore('master_pos','store_masterSupplierItem','store_supplierItemAutocomplete');}
me.store_supplierItemAutocomplete.proxy.extraParams.is_dropdown=1;me.store_supplierItemAutocomplete.proxy.extraParams.limit=999999;me.store_supplierItemAutocomplete.proxy.extraParams.keywords='';me.store_supplierItemListGrid=theApp.getStore('store_supplierItemListGrid',false);if(me.store_supplierItemListGrid==false){me.store_supplierItemListGrid=theApp.copyStore('master_pos','store_masterSupplierItem','store_supplierItemListGrid');}
me.store_supplierItemListGrid.proxy.extraParams.is_dropdown=0;me.store_supplierItemListGrid.proxy.extraParams.item_id=me.item_idx;me.store_supplierItemListGrid.proxy.extraParams.limit=999999;me.store_supplierItemListGrid.proxy.extraParams.supplier_id=0;me.store_supplierItemListGrid.proxy.extraParams.keywords='';return desktop.createWindow({id:me.id+'_list_supplierItem',title:Titletext,width:650,height:450,iconCls:'btn-search',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},defaultFocus:'keywords_search_supplierItem',items:[{xtype:'gridpanel',margins:'0 0 0 0',region:'center',store:me.store_supplierItemListGrid,id:'grid_list_supplierItem',scroll:true,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'supplier_item_id',text:'Supplier ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'supplier_id',text:'Supplier ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'item_id',text:'Item ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'unit_id',text:'Unit ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'supplier_name',text:'Supplier Name',width:200},{xtype:'gridcolumn',dataIndex:'unit_name',text:'Unit',width:100},{xtype:'gridcolumn',dataIndex:'item_price_show',text:'Item Price',width:100,align:'right'},{xtype:'gridcolumn',dataIndex:'item_hpp_show',text:'HPP (Average)',width:100,align:'right'}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_list_supplierItem').getSelectionModel().selected;if(getSelection.length>0){me.formType='edit';var d=me.store_supplierItemAutocomplete.getRange(0);var dataCatId=[];var no=1;for(var i=0;i<d.length;i++)
{dataCatId.push(d[i].data.id);}
var myMask2=new Ext.LoadMask(Ext.getCmp('grid_validasiOrderDetail'),{msg:"Loading..."});myMask2.show();var d=Ext.getCmp('grid_validasiOrderDetail').store.getRange(0);var dataTemp=[];var no=1;var total_detail=0;for(var i=0;i<d.length;i++)
{var dtDetVal={id:d[i].data.id,ro_id:d[i].data.ro_id,ro_detail_id:d[i].data.ro_detail_id,unit_id:d[i].data.unit_id,unit_name:d[i].data.unit_name,item_name:d[i].data.item_name,ro_detail_qty:d[i].data.ro_detail_qty,ro_detail_status_text:d[i].data.ro_detail_status_text,ro_detail_status:d[i].data.ro_detail_status,take_reff_id:d[i].data.take_reff_id,supplier_item_id:d[i].data.supplier_item_id,item_id:d[i].data.item_id,supplier_id:d[i].data.supplier_id,supplier_name:d[i].data.supplier_name,item_price:d[i].data.item_price,item_price_show:d[i].data.item_price_show,item_hpp:d[i].data.item_hpp,item_hpp_show:d[i].data.item_hpp_show,no:no}
if(rec.data.item_id==d[i].data.item_id){if(d[i].data.ro_detail_status=='request'||d[i].data.ro_detail_status=='validated'){}else{ExtApp.Msg.warning('Cannot edit validated item!');myMask2.hide();return false;}
dtDetVal['supplier_item_id']=rec.data.supplier_item_id;dtDetVal['supplier_id']=rec.data.supplier_id;dtDetVal['supplier_name']=rec.data.supplier_name;dtDetVal['item_price']=rec.data.item_price;dtDetVal['item_price_show']=rec.data.item_price_show;dtDetVal['item_hpp']=rec.data.item_hpp;dtDetVal['item_hpp_show']=rec.data.item_hpp_show;}
no++;dataTemp.push(dtDetVal);}
me.storeValidasiOrderDetail_dataTemp=dataTemp;Ext.getCmp('grid_validasiOrderDetail').store.loadData(me.storeValidasiOrderDetail_dataTemp);myMask2.hide();me.doClose(me.id+'_list_supplierItem');}}},dockedItems:[{xtype:'toolbar',dock:'top',items:['->',{text:'Refresh',itemId:'refreshButton_supplierItem',tooltip:'Refresh',iconCls:'btn-refresh',handler:function(){Ext.getCmp('grid_list_supplierItem').store.load();}}]}]}],buttons:[{text:'Close',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_list_supplierItem');}}],listeners:{boxready:function(){me.search_validasiOrder();}}});}});