/**
 * Filename: inventory.usageWaste.js
 * Generated 2019-03-07 at 01:39:14 AM
 */
Ext.define('ExtApp.modules.master_pos.model.model_masterItemDistribution',{extend:'Ext.data.Model',alias:'model_masterItemDistribution',fields:[{name:'id',type:'int'},{name:'item_code',type:'string'},{name:'item_name',type:'string'},{name:'item_code_name',type:'string'},{name:'sales_price',type:'string'},{name:'sales_price_show',type:'string'},{name:'item_price',type:'string'},{name:'item_price_show',type:'string'},{name:'item_hpp',type:'string'},{name:'item_hpp_show',type:'string'},{name:'unit_id',type:'int'},{name:'unit_name',type:'string'},{name:'last_in_item',type:'string'},{name:'use_stok_kode_unik',type:'int'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterItem/gridDataDistribution',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterUnit',{extend:'Ext.data.Model',alias:'model_masterUnit',fields:[{name:'id',type:'int'},{name:'unit_name',type:'string'},{name:'unit_code',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterUnit/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterStoreHouse',{extend:'Ext.data.Model',alias:'model_masterStoreHouse',fields:[{name:'id',type:'int'},{name:'storehouse_code',type:'string'},{name:'storehouse_name',type:'string'},{name:'storehouse_desc',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'is_primary',type:'int'},{name:'is_primary_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterStoreHouse/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.inventory.model.model_usageWaste',{extend:'Ext.data.Model',alias:'model_usageWaste',fields:[{name:'id',type:'int'},{name:'uw_number',type:'string'},{name:'uw_date',type:'string'},{name:'uw_date_text',type:'string'},{name:'uw_memo',type:'string'},{name:'uw_status',type:'string'},{name:'uw_status_text',type:'string'},{name:'uw_from',type:'int'},{name:'uw_from_name',type:'string'},{name:'uw_sales',type:'int'},],proxy:{type:'ajax',url:appUrl+'inventory/usageWaste/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.inventory.model.model_usageWasteDetail',{extend:'Ext.data.Model',alias:'model_usageWasteDetail',fields:[{name:'id',type:'string'},{name:'uw_id',type:'string'},{name:'item_id',type:'string'},{name:'item_code',type:'string'},{name:'item_code_name',type:'string'},{name:'item_name',type:'string'},{name:'item_price',type:'string'},{name:'item_hpp',type:'string'},{name:'item_hpp_show',type:'string'},{name:'uwd_qty',type:'string'},{name:'uwd_status',type:'string'},{name:'uwd_tipe',type:'string'},{name:'unit_name',type:'string'},{name:'unit_id',type:'string'},{name:'uwd_tipe',type:'string'},{name:'nomor',type:'int'}],proxy:{type:'ajax',url:appUrl+'inventory/usageWaste/gridDataDetail',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.store.store_masterItemDistribution',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterItemDistribution',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterUnit',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterUnit',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterStoreHouse',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterStoreHouse',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.inventory.store.store_usageWaste',{extend:'Ext.data.Store',model:'ExtApp.modules.inventory.model.model_usageWaste',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.inventory.store.store_usageWasteDetail',{extend:'Ext.data.Store',model:'ExtApp.modules.inventory.model.model_usageWasteDetail',autoLoad:false,remoteSort:true});Ext.define("ExtApp.modules.inventory.view.usageWaste",{openWindow:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var store_usageWaste_grid=theApp.getStore('store_usageWaste_grid',false);if(store_usageWaste_grid==false){store_usageWaste_grid=theApp.copyStore('inventory','store_usageWaste','store_usageWaste_grid');}
store_usageWaste_grid.proxy.extraParams.not_cancel=true;var helperGrid=theApp.getHelper('Grid');var phpJs=theApp.getHelper('phpJs');var selModel_usageWaste=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_usageWaste').down('#deleteButton_usageWaste').setDisabled(selections.length==0);}}});me.pagingtb_usageWaste=helperGrid.paging({ds:store_usageWaste_grid,title:' Usage & Waste/Penggunaan Barang'});return desktop.createWindow({id:me.id,title:'Usage & Waste',width:850,height:500,iconCls:'icon-grid',animCollapse:false,constrainHeader:true,resizable:true,maximized:false,border:false,border:0,layout:{type:'border'},items:[{xtype:'form',title:'Filter',width:330,region:'west',id:'form_filter_usageWaste',split:true,collapsible:true,splitterResize:false,collapseMode:'mini',animCollapse:true,scroll:false,bodyPadding:10,margin:'0 0 0 0',items:[{xtype:'textfield',name:'keywords',labelWidth:60,labelSeparator:'',emptyText:'Keywords: NO',anchor:'100%',margin:'0 0 15 0',listeners:{specialkey:function(field,e){if(e.getKey()==e.ENTER){me.search_usageWaste();}}}},{xtype:'panel',border:0,layout:{type:'column'},margin:'0 0 15 0',items:[{xtype:'datefield',fieldLabel:'Date From',name:'date_from',labelSeparator:'',format:'d-m-Y',altFormats:'Y-m-d|d-m-Y|dmY|Ymd',margin:'5 0 0 0',labelWidth:65,width:170,value:phpJs.date('d-m-Y'),allowBlank:false},{xtype:'datefield',fieldLabel:' To ',name:'date_till',labelSeparator:'',format:'d-m-Y',altFormats:'Y-m-d|d-m-Y|dmY|Ymd',margin:'5 0 0 10',labelWidth:20,width:125,value:phpJs.date('d-m-Y'),allowBlank:false}]},{xtype:'container',style:'text-align:right',border:0,items:[{xtype:'button',text:'Search',scale:'medium',margin:'15 0 0 0',itemId:'btnFilterSearch_usageWaste',tooltip:'Search',iconCls:'btn-search',handler:function(){me.search_usageWaste();}},{xtype:'button',text:'Reset',scale:'medium',margin:'15 60 0 10',itemId:'btnFilterReset_usageWaste',tooltip:'Reset',iconCls:'btn-reset',handler:function(){var form=Ext.getCmp('form_filter_usageWaste').getForm();form.reset();form.findField('keywords').setValue('');form.findField('date_from').setValue(phpJs.date('01-m-Y'));form.findField('date_till').setValue(phpJs.date('t-m-Y'));me.search_usageWaste();}}]}]},{xtype:'gridpanel',margins:'0 0 0 0',region:'center',store:store_usageWaste_grid,id:'grid_usageWaste',scroll:true,selModel:selModel_usageWaste,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'uw_number',text:'NO',width:100},{xtype:'datecolumn',dataIndex:'uw_date',text:'Date',width:100,format:'d-m-Y'},{xtype:'gridcolumn',dataIndex:'uw_from_name',text:'Warehouse',width:200},{xtype:'gridcolumn',dataIndex:'uw_status_text',text:'Status',width:80},{xtype:'gridcolumn',dataIndex:'uw_memo',text:'Memo',width:200}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_usageWaste').getSelectionModel().selected;if(getSelection.length>0){me.formType='edit';me.edit_data=rec.data;me.createWindow(me,'add_usageWaste');}}},bbar:me.pagingtb_usageWaste,dockedItems:[{xtype:'toolbar',dock:'top',items:[{text:'Filter',itemId:'filterButton_usageWaste',tooltip:'Filter Usage & Waste/Penggunaan Barang',iconCls:'btn-search',listeners:{click:function(){Ext.getCmp('form_filter_usageWaste').toggleCollapse();}}},'->',{text:'Add',itemId:'addButton_usageWaste',tooltip:'Add Usage & Waste/Penggunaan Barang',iconCls:'btn-add',listeners:{click:function(){me.formType='add';me.edit_data=[];me.createWindow(me,'add_usageWaste');}}},'-',{text:'Cancel',itemId:'deleteButton_usageWaste',tooltip:'Cancel Usage & Waste/Penggunaan Barang',iconCls:'btn-delete',disabled:true,listeners:{click:function(){var getSelection=Ext.getCmp('grid_usageWaste').getSelectionModel().selected;if(getSelection.length>0){me.delete_data=getSelection.items[0].data;if(me.delete_data.uw_status=='take'||me.delete_data.uw_status=='validated'){ExtApp.Msg.warning('Cannot Cancel '+me.delete_data.uw_number+'<br/> Usage & Waste/Penggunaan Barang been taken / used');}else{me.deleteConfirm_usageWaste();}}else{ExtApp.Msg.info('Please Select Usage & Waste/Penggunaan Barang!');}}}},'-',{text:'Refresh',itemId:'refreshButton_usageWaste',tooltip:'Refresh Usage & Waste/Penggunaan Barang',iconCls:'btn-refresh',listeners:{click:function(){me.search_usageWaste();}}}]}]}],listeners:{boxready:function(){Ext.getCmp('form_filter_usageWaste').toggleCollapse();me.search_usageWaste();},show:function(){}}});},add_usageWaste:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Add New Usage & Waste';if(me.formType=='edit'){Titletext='Update Usage & Waste';}
me.store_usageWasteDetailTemp=theApp.getStore('store_usageWasteDetailTemp',false);if(me.store_usageWasteDetailTemp==false){me.store_usageWasteDetailTemp=theApp.copyStore('inventory','store_usageWasteDetail','store_usageWasteDetailTemp');}
me.store_usageWasteDetailTemp.proxy.extraParams.limit=999999;var store_masterItem_usageWasteDetail=theApp.getStore('store_masterItem_usageWasteDetail',false);if(store_masterItem_usageWasteDetail==false){store_masterItem_usageWasteDetail=theApp.copyStore('master_pos','store_masterItemDistribution','store_masterItem_usageWasteDetail');}
store_masterItem_usageWasteDetail.proxy.extraParams.supplier_id=0;store_masterItem_usageWasteDetail.proxy.extraParams.item_id=0;store_masterItem_usageWasteDetail.proxy.extraParams.skip_date=1;store_masterItem_usageWasteDetail.proxy.extraParams.limit=999999;store_masterItem_usageWasteDetail.proxy.extraParams.is_last_stock=0;store_masterItem_usageWasteDetail.proxy.extraParams.is_dropdown=1;store_masterItem_usageWasteDetail.proxy.extraParams.storehouse_id=0;store_masterItem_usageWasteDetail.proxy.extraParams.from_module='usagewaste';store_masterItem_usageWasteDetail.proxy.extraParams.keywords='';var store_ComboboxMasterStoreHouse_usageWaste=theApp.getStore('store_ComboboxMasterStoreHouse_usageWaste',false);if(store_ComboboxMasterStoreHouse_usageWaste==false){store_ComboboxMasterStoreHouse_usageWaste=theApp.copyStore('master_pos','store_masterStoreHouse','store_ComboboxMasterStoreHouse_usageWaste');}
store_ComboboxMasterStoreHouse_usageWaste.proxy.extraParams.skip_date=0;store_ComboboxMasterStoreHouse_usageWaste.proxy.extraParams.limit=999999;store_ComboboxMasterStoreHouse_usageWaste.proxy.extraParams.is_dropdown=1;store_ComboboxMasterStoreHouse_usageWaste.proxy.extraParams.except_primary=1;store_ComboboxMasterStoreHouse_usageWaste.proxy.extraParams.is_active=1;store_ComboboxMasterStoreHouse_usageWaste.proxy.extraParams.show_all_text=0;store_ComboboxMasterStoreHouse_usageWaste.proxy.extraParams.show_choose_text=1;store_ComboboxMasterStoreHouse_usageWaste.proxy.extraParams.keywords='';var store_uw_tipe=new Ext.data.Store({fields:['val','name'],data:[{"val":"usage","name":"Usage"},{"val":"waste","name":"Waste"}],autoLoad:true});var helperGridDetail=theApp.getHelper('Grid');var phpJs=theApp.getHelper('phpJs');var selModel_usageWasteDetail=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_usageWasteDetail').down('#deleteButton_usageWasteDetail').setDisabled(selections.length==0);}}});return desktop.createWindow({id:me.id+'_add_usageWaste',title:Titletext,width:745,height:500,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:true,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'panel',height:490,margin:'0 0 10 0',border:false,items:[{xtype:'form',id:'form_usageWaste',border:0,bodyPadding:10,border:true,margin:'0 0 0 0',items:[{xtype:'hidden',name:'form_type_usageWaste',value:me.formType},{xtype:'hidden',name:'id'},{xtype:'hidden',name:'uw_sales'},{xtype:'fieldcontainer',layout:{type:'column'},fieldLabel:'',items:[{xtype:'textfield',name:'uw_number',fieldLabel:'NO',labelWidth:90,width:250,disabled:true,value:'auto',allowBlank:false},{xtype:'datefield',name:'uw_date',margin:'3 5 0 250',labelWidth:60,width:200,fieldLabel:'Date',format:'d-m-Y',submitFormat:'Y-m-d',allowBlank:false}]},{xtype:'hidden',name:'uw_from'},{xtype:'fieldcontainer',layout:{type:'column'},fieldLabel:'',items:[{xtype:'combobox',name:'uw_from_name',fieldLabel:'From',emptyText:'Pilih Gudang',labelWidth:90,width:350,store:store_ComboboxMasterStoreHouse_usageWaste,displayField:'storehouse_name',valueField:'id',queryMode:'local',allowBlank:false,margin:'0 50 0 0',listeners:{select:function(combo,records,eOpts){var form2=Ext.getCmp('form_usageWaste').getForm();form2.findField('uw_from').setValue(records[0].data.id);form2.findField('uw_from_name').setValue(records[0].data.storehouse_name);var myMask=new Ext.LoadMask(Ext.getCmp('add_item_id_usageWasteDetail'),{msg:"Load Item..."});myMask.show();store_masterItem_usageWasteDetail.proxy.extraParams.storehouse_id=records[0].data.id;store_masterItem_usageWasteDetail.load({callback:function(){myMask.hide();}});}}},{xtype:'radiogroup',fieldLabel:'Status',labelWidth:70,width:300,items:[{xtype:'radiofield',boxLabel:'Progress',name:'uw_status',inputValue:'progress',id:'uw_progress'},{xtype:'radiofield',boxLabel:'Done/Selesai',name:'uw_status',inputValue:'done',id:'uw_done'}]}]},{xtype:'hidden',name:'uw_status_old'},{xtype:'textfield',name:'uw_memo',fieldLabel:'Memo',labelWidth:90,width:350,allowBlank:true}]},{xtype:'form',border:true,id:'form_usageWasteDetail',bodyBorder:false,bodyPadding:10,title:'',pollForChanges:false,layout:{type:'auto'},items:[{xtype:'panel',layout:{type:'hbox',align:'left'},margin:'0 0 10 0',border:false,items:[{xtype:'hidden',name:'form_type_usageWasteDetail',value:me.formType},{xtype:'hidden',name:'id'},{xtype:'hidden',name:'uw_id'},{xtype:'hidden',name:'uwd_status'},{xtype:'hidden',name:'item_id'},{xtype:'hidden',name:'unit_id'},{xtype:'hidden',name:'item_name'},{xtype:'hidden',name:'item_code'},{xtype:'hidden',name:'item_hpp'},{xtype:'combobox',name:'item_code_name',id:'add_item_id_usageWasteDetail',fieldLabel:'Items',hideLabel:true,emptyText:'-Select Items-',width:230,style:'margin-right:5px',allowBlank:false,store:store_masterItem_usageWasteDetail,displayField:'item_code_name',valueField:'id',hideTrigger:true,queryMode:'local',anyMatch:true,listeners:{select:function(combo,records,eOpts){var form=Ext.getCmp('form_usageWaste').getForm();var form2=Ext.getCmp('form_usageWasteDetail').getForm();form2.findField('uw_id').setValue(form.findField('id').getValue());form2.findField('item_id').setValue(records[0].data.id);form2.findField('item_name').setValue(records[0].data.item_name);form2.findField('item_code').setValue(records[0].data.item_code);form2.findField('item_code_name').setValue(records[0].data.item_code_name);form2.findField('unit_id').setValue(records[0].data.unit_id);form2.findField('unit_name').setValue(records[0].data.unit_name);form2.findField('unit_name_show').setValue(records[0].data.unit_name);form2.findField('item_hpp').setValue(records[0].data.item_hpp);},specialkey:function(field,e){var form2=Ext.getCmp('form_usageWasteDetail').getForm();if(e.getKey()==e.ENTER){form2.findField('item_hpp').focus();}}}},{xtype:'combobox',name:'uwd_tipe',fieldLabel:'',emptyText:'-Tipe-',width:120,store:store_uw_tipe,queryMode:'local',hiddenName:"val",displayField:'name',valueField:'val',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false,labelWidth:0,style:'margin-right:5px',listeners:{specialkey:function(field,e){var form2=Ext.getCmp('form_usageWasteDetail').getForm();if(e.getKey()==e.ENTER){form2.findField('uwd_qty').focus();}}}},{xtype:'numberfield',name:'uwd_qty',fieldLabel:'Qty',emptyText:'-Qty-',hideLabel:true,style:'margin-right:5px',width:80,minValue:0,allowDecimals:true,allowBlank:false,hideTrigger:true,keyNavEnabled:false,mouseWheelEnabled:false},{xtype:'displayfield',name:'unit_name_show',fieldLabel:'Unit',hideLabel:true,emptyText:'-Unit Name-',value:'-',width:90,style:'margin-right:5px',readOnly:true,allowBlank:true},{xtype:'hidden',name:'unit_name',fieldLabel:'Unit',hideLabel:true,emptyText:'-Unit Name-',width:110,style:'margin-right:5px',readOnly:true,allowBlank:true},{xtype:'button',iconCls:'btn-add',name:'btnAdd_usageWasteDetail',id:'btnAdd_usageWasteDetail',width:70,text:'Add',margin:'0 10 0 10',handler:function(){me.add_usageWasteDetail();}},{xtype:'button',iconCls:'btn-reset',name:'btnReset_usageWasteDetail',id:'btnReset_usageWasteDetail',width:70,text:'Reset',handler:function(){me.reset_usageWasteDetail();}}]},{xtype:'panel',margin:'0 0 0 0',layout:'table',border:false,items:[{xtype:'gridpanel',store:me.store_usageWasteDetailTemp,id:'grid_usageWasteDetail',selModel:selModel_usageWasteDetail,scroll:true,width:710,height:250,border:true,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'Detail ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'item_id',text:'Supply ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'item_hpp',text:'HPP',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'item_code_name',text:'Price',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'item_hpp',text:'item_hpp',hidden:true,hideable:false},{xtype:'gridcolumn',width:120,dataIndex:'item_code',text:'Item Code',sortable:false},{xtype:'gridcolumn',width:150,dataIndex:'item_name',text:'Item Name',sortable:false},{xtype:'gridcolumn',width:150,dataIndex:'uwd_tipe',text:'Tipe',sortable:false},{xtype:'gridcolumn',width:85,dataIndex:'uwd_qty',text:'Qty',sortable:false},{xtype:'gridcolumn',width:120,dataIndex:'unit_name',text:'Unit',sortable:false},{xtype:'gridcolumn',width:120,dataIndex:'item_hpp_show',text:'HPP',sortable:false},],listeners:{itemdblclick:function(view,rec,item,index,eventObj){if(!me.edit_data){}else{if(me.edit_data.uw_status=='done'){ExtApp.Msg.warning('Cannot Edit Item, Change Status Usage & Waste to Progress and Save!');return true;}}
var form=Ext.getCmp('form_usageWasteDetail').getForm();form.reset();me.data_usageWasteDetail=rec.data;form.setValues(me.data_usageWasteDetail);form.findField('add_item_id_usageWasteDetail').setValue(me.data_usageWasteDetail.item_code_name);form.findField('form_type_usageWasteDetail').setValue('edit');form.findField('unit_name_show').setValue(me.data_usageWasteDetail.unit_name);form.findField('uwd_tipe').setValue(me.data_usageWasteDetail.uwd_tipe);Ext.getCmp('btnAdd_usageWasteDetail').setText('Edit');}},dockedItems:[{xtype:'toolbar',dock:'top',items:['->',{text:'Delete',itemId:'deleteButton_usageWasteDetail',tooltip:'Delete Usage & Waste Detail',iconCls:'btn-delete',disabled:true,handler:function(){var getSelection=Ext.getCmp('grid_usageWasteDetail').getSelectionModel().selected;if(getSelection.length>0){me.delete_data=getSelection.items[0].data;if(me.delete_data.uwd_status==1){ExtApp.Msg.info('Cannot Delete Item!, Please Change Status Usage/ Production');}else{me.deleteConfirm_usageWasteDetail();}}else{ExtApp.Msg.info('Please select the data to be deleted!');}}},]}]}]}]}]}],buttons:[{text:'Print',formBind:true,id:'btnPrint_usageWaste',iconCls:'btn-print',disabled:true,handler:function(){me.print_usageWaste();}},'->',{text:'Save',formBind:true,id:'btnSave_usageWaste',iconCls:'btn-save',handler:function(){me.save_usageWaste();}},{text:'Close',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_usageWaste');}}],listeners:{show:function(){var form=Ext.getCmp('form_usageWaste').getForm();var formD=Ext.getCmp('form_usageWasteDetail').getForm();var uw_id=-1;var rowguid=0;form.reset();Ext.getCmp('btnSave_usageWaste').setDisabled(false);form.findField('uw_date').setDisabled(false);form.findField('uw_from_name').setDisabled(false);if(form.findField('form_type_usageWaste').getValue()=='add'){form.findField('uw_date').setValue(phpJs.date("d-m-Y"));Ext.getCmp('btnPrint_usageWaste').setDisabled(true);me.store_usageWasteDetailTemp.proxy.extraParams.uw_id=uw_id;me.store_usageWasteDetailTemp.loadData([]);store_ComboboxMasterStoreHouse_usageWaste.load();var myMask=new Ext.LoadMask(Ext.getCmp('add_item_id_usageWasteDetail'),{msg:"Loading..."});myMask.show();store_masterItem_usageWasteDetail.load({callback:function(){myMask.hide();}});Ext.getCmp('uw_progress').setValue(true);Ext.getCmp('uw_done').setValue(false);}else{form.setValues(me.edit_data);Ext.getCmp('btnPrint_usageWaste').setDisabled(false);var uw_id=me.edit_data.id;formD.findField('uw_id').setValue(uw_id);store_ComboboxMasterStoreHouse_usageWaste.load();var myMask=new Ext.LoadMask(Ext.getCmp('add_item_id_usageWasteDetail'),{msg:"Loading..."});myMask.show();store_masterItem_usageWasteDetail.proxy.extraParams.storehouse_id=me.edit_data.uw_from;store_masterItem_usageWasteDetail.load({callback:function(){myMask.hide();}});Ext.getCmp('btnAdd_usageWasteDetail').setDisabled(false);if(me.edit_data.uw_status=='done'){Ext.getCmp('btnAdd_usageWasteDetail').setDisabled(true);}
var myMask2=new Ext.LoadMask(Ext.getCmp('grid_usageWasteDetail'),{msg:"Loading..."});myMask2.show();me.store_usageWasteDetailTemp.proxy.extraParams.uw_id=uw_id;me.store_usageWasteDetailTemp.proxy.extraParams.limit=99999;me.store_usageWasteDetailTemp.load({callback:function(){myMask2.hide();}});if(me.edit_data.uw_status=='done'||me.edit_data.uw_sales==1){form.findField('uw_date').setDisabled(true);form.findField('uw_from_name').setDisabled(true);}
if(me.edit_data.uw_status=='done'){Ext.getCmp('uw_progress').setValue(false);Ext.getCmp('uw_done').setValue(true);Ext.getCmp('btnPrint_usageWaste').setDisabled(false);}else{Ext.getCmp('uw_progress').setValue(true);Ext.getCmp('uw_done').setValue(false);Ext.getCmp('btnPrint_usageWaste').setDisabled(true);}}
me.reset_usageWasteDetail()}}});}});